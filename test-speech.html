<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Speech Synthesis Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 15px 30px;
            margin: 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background: #0056b3;
        }
        .log {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üé§ Speech Synthesis Test</h1>
        <p>This page tests if speech synthesis is working in your browser.</p>
        
        <div id="status" class="status info">Ready to test...</div>
        
        <div>
            <button onclick="testBasicSpeech()">Test Basic Speech</button>
            <button onclick="testWithVoice()">Test With Voice Selection</button>
            <button onclick="testMultipleVoices()">Test Multiple Voices</button>
            <button onclick="clearLog()">Clear Log</button>
        </div>
        
        <div class="log" id="log"></div>
    </div>

    <script>
        let logElement = document.getElementById('log');
        let statusElement = document.getElementById('status');
        
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logMessage = `[${timestamp}] ${message}\n`;
            logElement.textContent += logMessage;
            logElement.scrollTop = logElement.scrollHeight;
            console.log(message);
        }
        
        function updateStatus(message, type = 'info') {
            statusElement.textContent = message;
            statusElement.className = `status ${type}`;
        }
        
        function clearLog() {
            logElement.textContent = '';
            updateStatus('Log cleared', 'info');
        }
        
        function testBasicSpeech() {
            log('=== BASIC SPEECH TEST ===');
            updateStatus('Testing basic speech...', 'info');
            
            // Check if speech synthesis is available
            if (!('speechSynthesis' in window)) {
                log('‚ùå Speech synthesis not supported in this browser', 'error');
                updateStatus('Speech synthesis not supported', 'error');
                return;
            }
            
            log('‚úÖ Speech synthesis is supported');
            log(`Available voices: ${speechSynthesis.getVoices().length}`);
            log(`Currently speaking: ${speechSynthesis.speaking}`);
            log(`Pending: ${speechSynthesis.pending}`);
            
            const utterance = new SpeechSynthesisUtterance('Hello! This is a test of speech synthesis. Can you hear me?');
            utterance.rate = 1.0;
            utterance.pitch = 1.0;
            utterance.volume = 1.0;
            
            utterance.onstart = () => {
                log('‚úÖ Speech started successfully!');
                updateStatus('Speech started - check your speakers!', 'success');
            };
            
            utterance.onend = () => {
                log('‚úÖ Speech ended successfully!');
                updateStatus('Speech test completed', 'success');
            };
            
            utterance.onerror = (event) => {
                log(`‚ùå Speech error: ${event.error}`, 'error');
                updateStatus(`Speech error: ${event.error}`, 'error');
            };
            
            log('Starting speech synthesis...');
            try {
                speechSynthesis.speak(utterance);
                log('speechSynthesis.speak() called successfully');
            } catch (error) {
                log(`‚ùå Error calling speechSynthesis.speak(): ${error.message}`, 'error');
                updateStatus(`Error: ${error.message}`, 'error');
            }
        }
        
        function testWithVoice() {
            log('=== VOICE SELECTION TEST ===');
            updateStatus('Testing with voice selection...', 'info');
            
            const voices = speechSynthesis.getVoices();
            if (voices.length === 0) {
                log('‚ùå No voices available. Trying to load voices...');
                speechSynthesis.addEventListener('voiceschanged', () => {
                    log(`Voices loaded: ${speechSynthesis.getVoices().length}`);
                    testWithVoice();
                });
                return;
            }
            
            log(`Found ${voices.length} voices:`);
            voices.forEach((voice, index) => {
                log(`  ${index}: ${voice.name} (${voice.lang})`);
            });
            
            // Try to use the first English voice
            const englishVoice = voices.find(voice => voice.lang.startsWith('en')) || voices[0];
            log(`Using voice: ${englishVoice.name} (${englishVoice.lang})`);
            
            const utterance = new SpeechSynthesisUtterance('Hello! I am speaking with a selected voice. How do I sound?');
            utterance.voice = englishVoice;
            utterance.rate = 0.9;
            utterance.pitch = 1.1;
            utterance.volume = 1.0;
            
            utterance.onstart = () => {
                log('‚úÖ Voice selection test started!');
                updateStatus('Voice test started', 'success');
            };
            
            utterance.onend = () => {
                log('‚úÖ Voice selection test completed!');
                updateStatus('Voice test completed', 'success');
            };
            
            utterance.onerror = (event) => {
                log(`‚ùå Voice test error: ${event.error}`, 'error');
                updateStatus(`Voice test error: ${event.error}`, 'error');
            };
            
            speechSynthesis.speak(utterance);
        }
        
        function testMultipleVoices() {
            log('=== MULTIPLE VOICES TEST ===');
            updateStatus('Testing multiple voices...', 'info');
            
            const voices = speechSynthesis.getVoices();
            if (voices.length === 0) {
                log('‚ùå No voices available');
                return;
            }
            
            const testTexts = [
                'This is voice number one.',
                'This is voice number two.',
                'This is voice number three.'
            ];
            
            let currentIndex = 0;
            
            function speakNext() {
                if (currentIndex >= Math.min(3, voices.length)) {
                    log('‚úÖ Multiple voices test completed!');
                    updateStatus('Multiple voices test completed', 'success');
                    return;
                }
                
                const voice = voices[currentIndex];
                const text = testTexts[currentIndex] || `This is voice ${currentIndex + 1}.`;
                
                log(`Speaking with voice ${currentIndex + 1}: ${voice.name}`);
                
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.voice = voice;
                utterance.rate = 0.8;
                utterance.pitch = 1.0;
                utterance.volume = 1.0;
                
                utterance.onend = () => {
                    currentIndex++;
                    setTimeout(speakNext, 500); // Small delay between voices
                };
                
                utterance.onerror = (event) => {
                    log(`‚ùå Error with voice ${currentIndex + 1}: ${event.error}`, 'error');
                    currentIndex++;
                    setTimeout(speakNext, 500);
                };
                
                speechSynthesis.speak(utterance);
            }
            
            speakNext();
        }
        
        // Load voices when page loads
        window.addEventListener('load', () => {
            log('Page loaded, checking speech synthesis...');
            if ('speechSynthesis' in window) {
                log('‚úÖ Speech synthesis is available');
                const voices = speechSynthesis.getVoices();
                log(`Initial voices loaded: ${voices.length}`);
                
                // Some browsers load voices asynchronously
                speechSynthesis.addEventListener('voiceschanged', () => {
                    log(`Voices changed event - now ${speechSynthesis.getVoices().length} voices available`);
                });
            } else {
                log('‚ùå Speech synthesis not supported', 'error');
                updateStatus('Speech synthesis not supported in this browser', 'error');
            }
        });
    </script>
</body>
</html>
